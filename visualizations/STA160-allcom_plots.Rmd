---
title: "STA160-allcom_plots"
author: "Shih-Chi Chen"
date: "6/1/2022"
output:
  pdf_document: default
  html_document: default
---

```{r}
#import weather data combined fire data
all_com_wind_2 <- read.csv("~/Downloads/STA160/all_com_wind_2.txt")
```

```{r}
#change type to date
all_com_wind_2$Date <- as.Date(all_com_wind_2$Date)
all_com_wind_2$date.CONT_DATE.<- as.Date(all_com_wind_2$date.CONT_DATE.)

#fire days
days=all_com_wind_2$date.CONT_DATE.-all_com_wind_2$Date
#add to df
all_com_wind_2$cts_days=days
```

## EDA for all com

From the boxplot, it shows that the large fire (G) tend to have high wind speed.
```{r}
library(ggplot2)
library(ggridges)
ggplot(data = all_com_wind_2, mapping = aes(x = FIRE_SIZE_CLASS, y = wind_speed)) + 
  geom_boxplot()
```


From the plot, it shows that most of the reason for fires occur in the high average temperature. However, the Equipment Use causes fires to occur when average temperature is low. There also can be seen that the range of average temperature is large when the fire was caused by Miscellaneous and Arson. 
```{r}
ggplot(data = all_com_wind_2, mapping = aes(x = STAT_CAUSE_DESCR, y = average)) + 
   theme(legend.position="none") +
  geom_boxplot()+
  coord_flip()
```


```{r}
# load the library
#library(dplyr)
#library(forcats)

# Use position=position_dodge()
#ggplot(data=all_com_wind_2, aes(x=FIPS_NAME_y, y=Precip, fill=FIRE_SIZE_CLASS)) +
#geom_bar(stat="identity", position=position_dodge())

ggplot(data=all_com_wind_2, aes(x=FIPS_NAME_y, y=Precip, fill=FIRE_SIZE_CLASS)) +
  geom_bar(stat="identity")
```

```{r}
# Use position=position_dodge()
ggplot(data=all_com_wind_2, aes(x=FIPS_NAME_y, y=Precip, fill=STAT_CAUSE_DESCR)) +
geom_bar(stat="identity", position=position_dodge())
```

```{r}
theme_set(theme_ridges())

ggplot(all_com_wind_2, aes(x = average, y =FIPS_NAME_y )) +
  geom_density_ridges(aes(fill = FIPS_NAME_y)) 
```


